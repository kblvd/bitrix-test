<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1840113891']= array(base64_decode('a'.'XN'.'fc3Ry'.'aW5n'),base64_decode('c3Ryd'.'G9'.'s'.'b3dlcg=='),base64_decode('aXNfYXJyYXk='),base64_decode('a'.'XNfc3'.'Rya'.'W5n'),base64_decode('Z3'.'pkZWNv'.'Z'.'GU='),base64_decode(''.'Y'.'mFzZTY0X2R'.'l'.'Y29kZ'.'Q'.'=='),base64_decode('d'.'XJ'.'sZGVjb2Rl'),base64_decode('YXJyY'.'X'.'lfcmV2ZXJzZ'.'Q='.'='),base64_decode('Z3plbm'.'NvZ'.'GU='),base64_decode('Ym'.'FzZT'.'Y'.'0X'.'2VuY'.'29kZ'.'Q=='),base64_decode('dXJ'.'sZW5jb'.'2Rl'),base64_decode('Ym'.'lu'.'MmhleA=='),base64_decode('aX'.'NfYXJ'.'yYXk='),base64_decode('c3'.'Ry'.'dG9sb3dl'.'cg=='),base64_decode(''.'a'.'X'.'NfYXJyYX'.'k='),base64_decode('am9pbg=='),base64_decode('Zm5tYX'.'RjaA'.'=='),base64_decode('cm'.'F3dXJs'.'Z'.'GVjb2R'.'l'),base64_decode(''.'c3'.'Vic'.'3Ry'),base64_decode('c3Vic'.'3Ry'),base64_decode(''.'c3RyX3J'.'lcG'.'xh'.'Y2U'.'='),base64_decode(''.'cH'.'Jl'.'Z19xdW'.'90Z'.'Q='.'='),base64_decode(''.'cHJl'.'Z19tYXR'.'jaA=='));if(!function_exists(__NAMESPACE__.'\\___1583850139')){function ___1583850139($_225905606){static $_352382739= false; if($_352382739 == false) $_352382739=array(''.'YWN0aW9u',''.'a'.'W'.'50dmFs',''.'cG'.'F0aA'.'==','Y29'.'udGV4d'.'A'.'==',''.'a2V5'.'cw==','cHJvY'.'2Vz'.'cw='.'=','ZW5jb'.'2Rpbm'.'c'.'=','cHJ'.'lZ19y'.'ZXBsYWN'.'l','cGF0'.'aA==','Y29ud'.'GV'.'4'.'dA='.'=','a2V5'.'cw==',''.'cHJvY2V'.'zcw==','ZW5'.'jb2Rpbmc=',''.'cGF'.'0dG'.'Vy'.'bg'.'==','cH'.'J'.'lZ19'.'tYX'.'Rj'.'aA='.'=',''.'c'.'GF0'.'aA='.'=','Y29udGV4dA==','a'.'2V5cw==',''.'c'.'HJvY'.'2Vz'.'cw==','ZW5jb'.'2Rpbmc=','cGF0'.'d'.'GVybg==','cG9zdF9h'.'Y'.'3R'.'pb'.'24=',''.'Y2hlY2'.'tfY3Ny'.'Zg==','cG'.'F'.'0aA'.'==','Y29u'.'dGV4d'.'A==','a2V'.'5'.'cw==','cHJv'.'Y2Vzcw==','ZW5jb2Rpbm'.'c=',''.'cG'.'F0dGVybg==',''.'YWN'.'0aW9u','YWN0aW9u',''.'YWN'.'0a'.'W9u','YWN0aW9u',''.'YWN'.'0aW9'.'u','YWN0aW9u',''.'cG9zdF9hY'.'3Rp'.'b'.'24=',''.'ZW5'.'jb2Rpbmc=','ZW5jb'.'2Rpbmc=','ZW5jb2Rpbmc'.'=','ZW5jb'.'2Rpbmc'.'=','ZW'.'5jb'.'2Rp'.'bm'.'c=','ZW'.'5jb2Rp'.'bmc'.'=',''.'Z3'.'o=','YmFzZTY0','d'.'XJs',''.'a'.'GV4','Lg==','Lw==','a'.'W5kZXgucGhw','L2l'.'uZ'.'GV4'.'L'.'n'.'BocA==','U'.'0NSSVBU'.'X0'.'5BTUU=','L2luZGV'.'4'.'LnBocA==','U'.'0'.'NS'.'SVBUX05BTUU=','U0NS'.'S'.'VBUX05BTUU=','U'.'0'.'NSSVBUX05BT'.'UU'.'=','fg='.'=','fl4'.'=',''.'f'.'g==','XH4=',''.'J'.'H4=');return base64_decode($_352382739[$_225905606]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_814121924; protected $_1256843367; protected $_1077855353; protected $_1156017281; protected $_660603451; public static function make(array $_1965989215):?static{ $_1965989215= static::prepareRuleParameters($_1965989215); return match($_1965989215[___1583850139(0)]){ ___1583850139(1) => new IntvalRule( $_1965989215[___1583850139(2)], $_1965989215[___1583850139(3)], $_1965989215[___1583850139(4)], $_1965989215[___1583850139(5)], $_1965989215[___1583850139(6)]), ___1583850139(7) => new PregReplaceRule( $_1965989215[___1583850139(8)], $_1965989215[___1583850139(9)], $_1965989215[___1583850139(10)], $_1965989215[___1583850139(11)], $_1965989215[___1583850139(12)], $_1965989215[___1583850139(13)]), ___1583850139(14) => new PregMatchRule( $_1965989215[___1583850139(15)], $_1965989215[___1583850139(16)], $_1965989215[___1583850139(17)], $_1965989215[___1583850139(18)], $_1965989215[___1583850139(19)], $_1965989215[___1583850139(20)], $_1965989215[___1583850139(21)]), ___1583850139(22) => new CsrfRule( $_1965989215[___1583850139(23)], $_1965989215[___1583850139(24)], $_1965989215[___1583850139(25)], $_1965989215[___1583850139(26)], $_1965989215[___1583850139(27)], $_1965989215[___1583850139(28)],), default => null,};} protected static function prepareRuleParameters(array $_1322246955): array{ if($GLOBALS['____1840113891'][0]($_1322246955[___1583850139(29)])){ $_1322246955[___1583850139(30)]= $GLOBALS['____1840113891'][1]($_1322246955[___1583850139(31)]);} elseif($GLOBALS['____1840113891'][2]($_1322246955[___1583850139(32)])){ $_1932632422= $_1322246955[___1583850139(33)]; $_1322246955[___1583850139(34)]= $_1932632422[(190*2-380)]; $_1322246955[___1583850139(35)]= $_1932632422[round(0+1)];} $_1322246955[___1583850139(36)]=!empty($_1322246955[___1583850139(37)])? $_1322246955[___1583850139(38)]:[]; if($GLOBALS['____1840113891'][3]($_1322246955[___1583850139(39)])){ $_1322246955[___1583850139(40)]=[$_1322246955[___1583850139(41)]];} return $_1322246955;}  public function __construct($_814121924, $_1256843367, $_1077855353, $_1156017281, $_660603451){ $this->_814121924= $_814121924; $this->_1256843367= $this->castContext($_1256843367); $this->_1077855353= $this->castKeys($_1077855353); $this->_1156017281= $_1156017281; $this->_660603451= $_660603451;} public function evaluateValue($_1027273342){ if(!empty($this->_660603451)){ foreach($this->_660603451 as $_289606863){ $_1027273342= match($_289606863){ 'gz' => $GLOBALS['____1840113891'][4]($_1027273342), 'base64' => $GLOBALS['____1840113891'][5]($_1027273342), 'url' => $GLOBALS['____1840113891'][6]($_1027273342), 'hex' => hex2bin($_1027273342)};}} $_1108279937= $this->evaluate($_1027273342); if(!empty($this->_660603451) && $_1108279937 instanceof ModifyResult){ $_177954637= $_1108279937->getCleanValue(); foreach($GLOBALS['____1840113891'][7]($this->_660603451) as $_289606863){ $_177954637= match($_289606863){ ___1583850139(42) => $GLOBALS['____1840113891'][8]($_177954637), ___1583850139(43) => $GLOBALS['____1840113891'][9]($_177954637), ___1583850139(44) => $GLOBALS['____1840113891'][10]($_177954637), ___1583850139(45) => $GLOBALS['____1840113891'][11]($_177954637)};} $_1108279937= new ModifyResult($_177954637);} return $_1108279937;} abstract public function evaluate($_1027273342); protected function castContext($_1256843367){ if(!$GLOBALS['____1840113891'][12]($_1256843367)){ $_1256843367=[$_1256843367];} foreach($_1256843367 as $_1225299554 => $_573787154){ $_1256843367[$_1225299554]= $GLOBALS['____1840113891'][13]($_573787154);} return $_1256843367;} protected function castKeys($_1077855353){ if(!$GLOBALS['____1840113891'][14]($_1077855353)){ $_1077855353=[$_1077855353];} return $_1077855353;} public function matchKey(array $_600471521): bool{ $_600471521= $GLOBALS['____1840113891'][15](___1583850139(46), $_600471521); foreach($this->_1077855353 as $_1350680209){   if($GLOBALS['____1840113891'][16]($_1350680209, $_600471521)){ return true;}} return false;}  public function matchPath($_587354741){ if($this->_814121924 === '*'){ return true;}  $_1257686074= new Uri($_587354741); $_1086111578= $_1257686074->getPath(); $_1086111578= $GLOBALS['____1840113891'][17]($_1086111578);      if(str_ends_with($_1086111578, ___1583850139(47))){ $_1086111578 .= ___1583850139(48);} $_1086111578= Path::normalize($_1086111578);  $_872965142[]= $_1086111578; if(str_ends_with($_1086111578, ___1583850139(49))){ $_872965142[]= $GLOBALS['____1840113891'][18]($_1086111578, min(168,0,56),-round(0+3+3+3));} elseif(str_ends_with($_SERVER[___1583850139(50)], ___1583850139(51))){ $_872965142[]= $GLOBALS['____1840113891'][19]($_SERVER[___1583850139(52)],(968-2*484),-round(0+4.5+4.5));} if($_1086111578 !== $_SERVER[___1583850139(53)]){ $_872965142[]= $_SERVER[___1583850139(54)];}  if(str_starts_with($this->_814121924, ___1583850139(55))){ $_1070946727= $this->_814121924;} else{ $_1070946727= ___1583850139(56). $GLOBALS['____1840113891'][20](___1583850139(57), ___1583850139(58), $GLOBALS['____1840113891'][21]($this->_814121924)). ___1583850139(59);} foreach($_872965142 as $_705092341){ if($this->_814121924 === $_705092341 || $GLOBALS['____1840113891'][22]($_1070946727, $_705092341)){ return true;}} return false;}  public function getPath(){ return $this->_814121924;}  public function getContext(){ return $this->_1256843367;}  public function getKeys(){ return $this->_1077855353;}  public function getProcess(){ return $this->_1156017281;}}?>